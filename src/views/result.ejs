<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>결과</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/public/css/result.css">
    <link rel="stylesheet" href="/public/css/style.css">
</head>
<body>
<div class="container p-5 text-center">
    <div class="container p-5">
        <div id="count">
            <div class="counter">
                <div class="nums">
                    <span class="in">3</span>
                    <span>2</span>
                    <span>1</span>
                    <span>0</span>
                </div>
                <h4>곧 결과가 나옵니다.</h4>
            </div>
        </div>
        <div id="result" class="final">
            <div class="line">
                <div class="seat">
                    <p class="name"><%= number[0] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[1] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[2] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[3] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[4] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[5] %> 번</p>
                </div>
            </div>
            <div class="line">
                <div class="seat">
                    <p class="name"><%= number[6] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[7] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[8] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[9] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[10] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[11] %> 번</p>
                </div>
            </div>
            <div class="line">
                <div class="seat">
                    <p class="name "><%= number[12] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[13] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[14] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[15] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[16] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[17] %> 번</p>
                </div>
            </div>
            <div class="line">
                <div class="seat">
                    <p class="name"><%= number[18] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[19] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[20] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[21] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[22] %> 번</p>
                </div>
                <div class="seat">
                    <p class="name"><%= number[23] %> 번</p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const nums = document.querySelectorAll('.nums span');
    const counter = document.querySelector('.counter');
    const finalMessage = document.querySelector('.final');
    const repl = document.getElementById('replay');

    runAnimation();

    function resetDOM() {
        counter.classList.remove('hide');
        finalMessage.classList.remove('show');

        nums.forEach(num => {
            num.classList.value = '';
        });

        nums[0].classList.add('in');
    }

    function runAnimation() {
        nums.forEach((num, idx) => {
            const penultimate = nums.length - 1;
            num.addEventListener('animationend', (e) => {
                if(e.animationName === 'goIn' && idx !== penultimate){
                    num.classList.remove('in');
                    num.classList.add('out');
                } else if (e.animationName === 'goOut' && num.nextElementSibling){
                    num.nextElementSibling.classList.add('in');
                } else {
                    counter.classList.add('hide');
                    finalMessage.classList.add('show');
                }
            });
        });
    }

    repl.addEventListener('click', () => {
        resetDOM();
        runAnimation();
    });
</script>
</body>